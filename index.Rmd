---
title: "Melville Rotisserie Standings"
author: "High Honorable League Commissioner Coach Mister Professor Michael"
date: "`r Sys.Date()`"
output:
  html_document:
    toc: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(baseballr)
library(lubridate)
library(kableExtra)
library(purrr)
library(DT)

# Run source code to pull data from bbref, clean rosters and stats - will run to present day by calling Sys.Date()
# Initial date of league start needs to be hard coded
source("~/GitHub/Melville_Rotisserie/R/clean_bbref_multi.R")
```

# League Rules

- The league is live!

- Teams accumulate stats from June 10 to August 15.

- You get points based on your rank in each statistical category. If you are in first place in, for example, batting average - you get 5 points. If you are in second place - 3 points. Third place - 1 point. Fourth place - you get bupkis.

- Your lineup consists of:

  - 8 starting position players
  - 1 Util/DH player
  - 4 pitchers (starting pitchers only)
  - 4 bench players (C, IF, OF, P).

- There are no trades or adding/dropping players. The only exception is if a player is officially placed on injured reserve (IR) by their team.

- If a player is placed on IR by their team: 

You can then drop that player from your roster, and your bench player can be substituted (as OF, IF, or P). Their stats for the whole period will be used instead. You aren't allowed to bring the injured player back. For example, if Bryce Harper gets hurt, and you replace him at 1B with reserve IF Pete Alonso from your bench... you can't bring Harper back later in the season - he's "flushed". You can replace Alonso on your bench with a free agent.

You do not have to replace the injured player if you don't want! Let's say Player X had a great season, and gets injured a week before the end of the season - if you think it's worth missing a week's worth of production and keeping him on your roster, you certainly can!

- Signing free agents to fill your empty roster spot: 

If you decide to drop an injured player and substitute a bench player, you will have an empty spot on your team. Look up a new player you'd like to sign, and communicate to the Commissioner that you'd like to add that player to your roster.

- All roster moves need to be communicated to High Honorable League Commissioner Coach Mister Professor Michael. Use email or text.

# News and Notes

- 6/10: Isaac dropped Alex Bregman (BOS) prior to the start of the season - he drafted him without knowing he was on IR. He replaced him at 3B with Alec Bohm (PHI).

- 6/15: Michael dropped Nathan Eovaldi (TEX), who was placed on Injured Reserve, and replaced him with Robbie Ray (SF) from the Bench. He picked up Kodai Senga (NYM), who is now his bench pitcher.

- 6/15: Rafael Devers was traded from Boston to San Francisco, where he is expected to play 3rd because Matt Chapman is injured. As was discussed at the draft, he had been playing DH only with Boston, and went undrafted.

- 6/15: League rules were updated to explain more about adding/dropping injured players.

# Current Standings

*Data are pulled from Baseball Reference via baseballR on the date indicated in the page header*

Bold-face numbers indicate the leader in each statistical category. 

```{r standings, echo = FALSE}
# Render Standings

left_join(stats_batting, stats_pitching, by = c("Owner" = "Owner")) %>%
  left_join(points_table, by = c("Owner" = "Owner")) %>%
  arrange(-Points) %>%
  mutate(across(where(is.numeric), ~ bold_stat(., cur_column()))) %>%
  select(Owner, Points, everything()) %>%
  kable(escape = FALSE) %>%
  kable_styling()

```

# Sortable Player Statistics

Sort through team and player statistics. You can type in your team's name in the search bar to look at only your team OR search for an individual player by name. This table only contains players drafted in the Melville Rotisserie league.

You can click on a statistic to sort the players from highest-to-lowest or lowest-to-highest.

## Batters


```{r echo=FALSE}
# Roster display - Batters
datatable(batter_roster %>%
            filter(batter_pitcher == "Batter") %>%
            select(Name, Position, Owner, 
                   Team, G, AB, H, BB, HR, RBI, SB, BA, 
                  OPS), 
          options = list(pageLength = 12))

```


## Pitchers

```{r echo=FALSE}
datatable(pitcher_roster %>%
            select(Name, Position, Owner, Team,
                   G, W, L, IP, H, BB, ER, SO, ERA, WHIP), 
          options = list(pageLength = 5))

```


# Statistics Guide

How do we calculate the statistics we are using in the league?

## Batting Stats

-BA (Batting Average): Total Team Hits / Total Team At Bats

-HR: Total team home runs

-RBI: Total team runs batted in

-SB: Total team stolen bases

-OPS (On base pct plus slugging pct): (Hits + Walks / Plate Appearances) + (Total Bases / At bats)

## Pitching Stats

-IP: Total team innings pitched

-SO: Total team strikeouts

-ERA (Earned Run Average): Total earned runs per 9 innings

-WHIP: (Walks + Hits) / Innings Pitched
